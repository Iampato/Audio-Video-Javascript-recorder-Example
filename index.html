<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Audio/Video Example - Record Plugin for Video.js</title>
    <link href="https://vjs.zencdn.net/7.6.6/video-js.min.css" rel="stylesheet">
    <link href="https://unpkg.com/videojs-wavesurfer/dist/css/videojs.wavesurfer.min.css" rel="stylesheet">
    <link href="css/videojs.record.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">

    <script src="https://vjs.zencdn.net/7.6.6/video.min.js"></script>
    <script src="https://unpkg.com/recordrtc/RecordRTC.js"></script>
    <script src="https://unpkg.com/webrtc-adapter/out/adapter.js"></script>
    <script src="https://unpkg.com/wavesurfer.js/dist/wavesurfer.min.js"></script>
    <script src="https://unpkg.com/wavesurfer.js/dist/plugin/wavesurfer.microphone.min.js"></script>
    <script src="https://unpkg.com/videojs-wavesurfer/dist/videojs.wavesurfer.min.js"></script>



    <script src="js/videojs.record.min.js"></script>

    <script src="js/browser-workarounds.js"></script>

    <style>
        /* change player background color */
        
        #myVideo {
            background-color: #9ab87a;
        }
    </style>
</head>

<body>

    <center><audio id="myAudio" class="video-js vjs-default-skin" style="background-color: #9ab87a;"></audio></center>
    <br><br>
    <center>
        <Button id="save" onclick="saveVideo()">Save</Button>
    </center>

    <script>
        var SaveButton = document.getElementById('save');
        var options = {
            controls: true,
            width: 600,
            height: 300,
            plugins: {
                wavesurfer: {
                    src: 'live',
                    waveColor: '#36393b',
                    progressColor: 'black',
                    debug: true,
                    cursorWidth: 1,
                    msDisplayMax: 20,
                    hideScrollbar: true
                },
                record: {
                    audio: true,
                    video: false,
                    maxLength: 20,
                    debug: true
                }
            }
        };

        // apply some workarounds for certain browsers
        applyAudioWorkaround();

        // create player
        var player = videojs('myAudio', options, function() {
            // print version information at startup
            var msg = 'Using video.js ' + videojs.VERSION +
                ' with videojs-record ' + videojs.getPluginVersion('record') +
                ', videojs-wavesurfer ' + videojs.getPluginVersion('wavesurfer') +
                ', wavesurfer.js ' + WaveSurfer.VERSION + ' and recordrtc ' +
                RecordRTC.version;
            videojs.log(msg);
        });

        // error handling
        player.on('deviceError', function() {
            console.log('device error:', player.deviceErrorCode);
        });

        player.on('error', function(element, error) {
            console.error(error);
        });

        // user clicked the record button and started recording
        player.on('startRecord', function() {
            SaveButton.style.display = 'none';
            console.log('started recording!');
        });

        // user completed recording and stream is available
        player.on('finishRecord', function() {
            SaveButton.style.display = 'block';
            console.log('finished recording: ', player.recordedData);
        });

        function saveVideo() {
            var today = new Date();
            console.log('recording saved: ', player.recordedData);
            player.record().saveAs({
                'audio': today + '.wav'
            });
        }
    </script>
</body>

</html>

<!-- 
<body>
    <center>
        <video id="myVideo" playsinline class="video-js vjs-default-skin">
        <p class="vjs-no-js">
            To view this video please enable JavaScript, or consider upgrading to a
            web browser that
            <a href="https://videojs.com/html5-video-support/" target="_blank">
                supports HTML5 video.
            </a>
        </p>
    </video>
    </center>
    <br><br>
    <center>
        <Button id="save" onclick="saveVideo()">Save</Button>
    </center>

    <script>
        var SaveButton = document.getElementById('save');

        var options = {
            controls: true,
            width: 320,
            height: 240,
            plugins: {
                record: {
                    audio: true,
                    video: true,
                    maxLength: 10,
                    debug: true
                }
            }
        };

        // apply some workarounds for certain browsers
        applyVideoWorkaround();

        var player = videojs('myVideo', options, function() {
            // print version information at startup
            var msg = 'Using video.js ' + videojs.VERSION +
                ' with videojs-record ' + videojs.getPluginVersion('record') +
                ' and recordrtc ' + RecordRTC.version;
            videojs.log(msg);
        });

        // error handling
        player.on('deviceError', function() {
            console.log('device error:', player.deviceErrorCode);
        });

        player.on('error', function(element, error) {
            console.error(error);
        });

        // user clicked the record button and started recording
        player.on('startRecord', function() {
            SaveButton.style.display = 'none';
            console.log('started recording!');
        });

        // user completed recording and stream is available
        player.on('finishRecord', function() {
            SaveButton.style.display = 'block';
            console.log('finished recording: ', player.recordedData);
        });

        function saveVideo() {
            var today = new Date();
            player.record().saveAs({
                'video': today + '.webm'
            });
        }
    </script>

</body>

</html> -->